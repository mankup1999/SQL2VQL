create table BCC_WK_MIOTV_GA_OED_RAW as  SELECT DISTINCT ORD_TRA
N.ORD_ACTN_ID        AS ORD_ACTN_ID ,                 ORD_TRAN.O
RD_ACTN_STRT_TS   AS ORD_ACTN_STRT_TS ,                 ORD_TRAN
.ORD_ACTN_STRT_DATE_KEY,                 ORD_TRAN.MAIN_CMPN_NM,
ORD_TRAN.ASSG_PROD_ID       AS ASSG_PROD_ID ,
ORD_TRAN.MAIN_CMPN_ID,                 ORD_TRAN.AS
SG_PRCE_PLAN_ID  as ASSG_PRCE_PLAN_ID,                 ORD_TRAN.
SERV_TYPE_CD       AS SERV_TYPE_CD,                 ORD_TRAN.ORD
_ACTN_DONE_TS   AS ORD_ACTN_DONE_TS ,                 ORD_TRAN.O
RD_ACTN_DONE_DATE_KEY,                 ORD_TRAN.DEAL_ID,
ORD_TRAN.DEAL_NM,      -- Added on 13 Aug 18
EMPL.EMPL_or_SSMN_CD,   -- Added on 13 Aug 18
SUBS.PRIM_RSRC_VALU_TXT     AS PRIM_RSRC_VALU_TXT ,
SUBS.SUBS_ID                AS SUBS_ID ,
OA_STTS.ORD_ACTN_STTS_DS    as ORD_ACTN_STTS_DS ,
OA_TYPE.ORD_ACTN_TYPE_DS    AS ORD_ACTN_TYPE_DS ,
OA_RSN.ORD_ACTN_RSN_DS      AS ORD_ACTN_RSN_DS ,
CTCT.IDNT_DOC_1_NO          AS CUST_CTCT_IDNT_DOC_1_NO
,                 CTCT.FRST_NM,                 CUST.CUST_ID,
ASSG_BILL_OFFR.BILL_OFFR_DS BILL_OFFR_DS,
ASSG_BILL_OFFR.BASE_PLAN_IND,                  ASSG_CMP
N_OFFR.PROD_DS CMPN_PROD_DS,                 ASSG_PROD_STAT.ASSG
_PROD_STAT_ID,                 CHNL_NM.SALE_SERV_CHNL_NM   FROM
EP_REL.ORD_TRAN,       (SELECT SUBS_KEY,SUBS_ID,PRIM_RSRC_VALU_T
XT,OPEN_TS,CLSE_TS                 FROM EP_REL.SUBS WHERE  ECF_D
ELT_FLG = 0            ) SUBS,       (SELECT ORD_ACTN_STTS_KEY,O
RD_ACTN_STTS_DS,OPEN_TS,CLSE_TS                  FROM EP_REL.ORD
_ACTN_STTS  WHERE  ECF_DELT_FLG = 0  ) OA_STTS,       (SELECT OR
D_ACTN_TYPE_KEY,ORD_ACTN_TYPE_DS,ORD_ACTN_TYPE_ID,OPEN_TS,CLSE_T
S FROM EP_REL.ORD_ACTN_TYPE  WHERE  ECF_DELT_FLG = 0  ) OA_TYPE,
(SELECT ORD_ACTN_RSN_KEY,ORD_ACTN_RSN_DS,ORD_ACTN_RSN_ID,
OPEN_TS,CLSE_TS    FROM EP_REL.ORD_ACTN_RSN  WHERE  ECF_DELT_FLG
= 0   ) OA_RSN,       (SELECT CTCT_KEY,IDNT_DOC_1_NO,OPEN_TS,CL
SE_TS,FRST_NM                      FROM EP_REL.CTCT WHERE  ECF_D
ELT_FLG = 0            ) CTCT,       (SELECT CUST_KEY,CUST_ID,OP
EN_TS,CLSE_TS                                    FROM EP_REL.CUS
T WHERE  ECF_DELT_FLG = 0            ) CUST,       (SELECT BASE_
PLAN_IND,OPEN_TS,CLSE_TS,BILL_OFFR_KEY,BILL_OFFR_DS            F
ROM EP_REL.BILL_OFFR WHERE  ECF_DELT_FLG = 0       ) ASSG_BILL_O
FFR,       (SELECT PROD_CTLG_ITEM_ID,PROD_CTLG_KEY, PROD_DS,OPEN
_TS,CLSE_TS            FROM EP_REL.PROD_CTLG WHERE  ECF_DELT_FLG
= 0       ) ASSG_CMPN_OFFR,       (SELECT ASSG_PROD_STAT_ID,OPE
N_TS,CLSE_TS,ASSG_PROD_STAT_KEY                FROM EP_REL.ASSG_
PROD_STAT WHERE  ECF_DELT_FLG = 0  ) ASSG_PROD_STAT,       (SELE
CT SALE_SERV_CHNL_KEY, SALE_SERV_CHNL_NM, OPEN_TS, CLSE_TS
FROM EP_REL.SALE_SERV_CHNL WHERE  ECF_DELT_FLG = 0  ) CHN
L_NM,       (SELECT EMPL_OR_SSMN_CD,OPEN_TS,CLSE_TS,EMPL_KEY fro
m EP_REL.EMPL  where ECF_DELT_FLG = 0) EMPL  -- Added on 13 Aug
18   WHERE   ORD_TRAN.SUBS_KEY                   = SUBS.SUBS_KEY
(+)   AND ORD_TRAN.BILL_OFFR_KEY          = ASSG_BILL_OFFR.BILL
_OFFR_KEY (+)   AND ORD_TRAN.PROD_CTLG_KEY          = ASSG_CMPN_
OFFR.PROD_CTLG_KEY (+)   AND ORD_TRAN.ORD_ACTN_STTS_KEY      = O
A_STTS.ORD_ACTN_STTS_KEY (+)   AND ORD_TRAN.ORD_ACTN_TYPE_KEY
= OA_TYPE.ORD_ACTN_TYPE_KEY (+)   AND ORD_TRAN.ORD_ACTN_RSN_K
EY       = OA_RSN.ORD_ACTN_RSN_KEY (+)   AND ORD_TRAN.MAIN_CTCT_
KEY          = CTCT.CTCT_KEY(+)   AND ORD_TRAN.CUST_KEY
= CUST.CUST_KEY(+)   AND ORD_TRAN.ASSG_PROD_STAT_KEY     =
ASSG_PROD_STAT.ASSG_PROD_STAT_KEY(+)   AND ORD_TRAN.INIT_SALE_S
ERV_CHNL_KEY = CHNL_NM.SALE_SERV_CHNL_KEY(+)   AND ORD_TRAN.OPEN
_TS                >= SUBS.OPEN_TS (+)   and ORD_TRAN.OPEN_TS
< SUBS.CLSE_TS (+)   AND ORD_TRAN.OPEN_TS
>= OA_STTS.OPEN_TS (+)   AND ORD_TRAN.OPEN_TS
< OA_STTS.CLSE_TS (+)   AND ORD_TRAN.OPEN_TS                >
= OA_TYPE.OPEN_TS (+)   AND ORD_TRAN.OPEN_TS                < OA
_TYPE.CLSE_TS (+)   AND ORD_TRAN.OPEN_TS                >= OA_RS
N.OPEN_TS (+)   AND ORD_TRAN.OPEN_TS                < OA_RSN.CLS
E_TS (+)   AND ORD_TRAN.OPEN_TS                >= CTCT.OPEN_TS (
+)   AND ORD_TRAN.OPEN_TS                < CTCT.CLSE_TS (+)   AN
D ORD_TRAN.OPEN_TS                >= CUST.OPEN_TS (+)   and ORD_
TRAN.OPEN_TS                < CUST.CLSE_TS (+)   AND ORD_TRAN.OP
EN_TS                >= ASSG_BILL_OFFR.OPEN_TS (+)   AND ORD_TRA
N.OPEN_TS                < ASSG_BILL_OFFR.CLSE_TS (+)   AND ORD_
TRAN.OPEN_TS                >= ASSG_CMPN_OFFR.OPEN_TS (+)   AND
ORD_TRAN.OPEN_TS                < ASSG_CMPN_OFFR.CLSE_TS (+)   A
ND ORD_TRAN.OPEN_TS                >= ASSG_PROD_STAT.OPEN_TS (+)
AND ORD_TRAN.OPEN_TS                < ASSG_PROD_STAT.CLSE_TS
(+)   AND ORD_TRAN.OPEN_TS                >= CHNL_NM.OPEN_TS (+)
AND ORD_TRAN.OPEN_TS                < CHNL_NM.CLSE_TS (+)   A
ND ORD_TRAN.CRTE_EMPL_KEY          = EMPL.EMPL_KEY(+) -- Added
AND ORD_TRAN.OPEN_TS            >= EMPL.OPEN_TS (+)    -- Added
AND ORD_TRAN.OPEN_TS            < EMPL.CLSE_TS (+)     -- Add
ed    AND UPPER(ORD_TRAN.MAIN_CMPN_NM) IN ('TV MAIN','CROSS CARR
IAGE MAIN')   AND UPPER(OA_TYPE.ORD_ACTN_TYPE_DS) IN ( 'PROVIDE'
)   AND ORD_TRAN.ECF_DELT_FLG = 0   AND UPPER(CTCT.FRST_NM) not
like 'BRT%'   AND ORD_TRAN.ORD_ACTN_STRT_DATE_KEY BETWEEN TO_CH
AR(TRUNC(SYSDATE-7, 'IW'),'YYYYMMDD') AND TO_CHAR(NEXT_DAY(TRUNC
(SYSDATE-7,'IW'),'SUNDAY'),'YYYYMMDD')   --AND ORD_TRAN.ORD_ACTN
_STRT_DATE_KEY BETWEEN 20180910 and 20180916   --AND ASSG_CMPN_O
FFR.PROD_CTLG_ITEM_ID in ('8635012' ,'8900892' ,'8704672' ,'8633
012' ,'8632982')